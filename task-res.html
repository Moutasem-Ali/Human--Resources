<!DOCTYPE html>
<html lang="en" dir="rtl" >
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>المهام المستلمة</title>
    <!-- Bootstrap CSS -->
    <link href="bootstrap-5.3.3-dist/css/bootstrap.min.css" rel="stylesheet" />
    
    <link rel="stylesheet" href="css/home.css">
    <style>
   
@font-face {
  font-family: 'Cairo';
  src: url('fonts/Cairo-Regular.ttf') format('truetype');
      
  font-weight: 400;
}
.clickable-row {
        cursor: pointer;
      }
      .clickable-row:hover {
        background-color: #f5f5f5;
      }

     </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg  bg-body-tertiary">
        <div class="container-fluid">
          <a class="navbar-brand" href="index.html">الرئيسية</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="report.html">تقرير الحضور</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="Leave-Request.html">طلب إجازة</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="add-task.html">اضافه المهمة</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="task-sending.html"> المهام المرسلة</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="task-res.html"> المهام المستلمة</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="chat.html"> المراسلات الرسمية </a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="settings.html">الاعدادات</a>
              </li>
              
            </ul>
          </div>
        </div>
      </nav>
  <div id="contentToPrint">
      <h3  class="centered-heading">المهام المستلمة </h3>
     <div class="form-container">
        <div  class="datetime-container">
          <div class="date-group">
            <label for="inputDate">من تاريخ</label>
            <input type="date" class="form-control" id="inputDate" placeholder="اختر التاريخ">
          </div>
          <div class="date-group">
            <label for="inputDate">الى تاريخ</label>
            <input type="date" class="form-control" id="inputDate1" placeholder="اختر التاريخ">
          </div >
         
       </div>
       <div class="form-group mb-3 col-md-4">
        <label for="kind-req"> قائمة المهمة</label>
        <div class="select-wrapper">
            <select class="form-select" >
                <option value="" disabled selected>اختر المهمة</option>
                <option value="1"> عطلة صيفية</option>
                <option value="2"> اسبوع</option>
                <option value="3"> شهر</option>
                <option value="4">شهرين </option>
            </select>
        </div>
    </div>
       <div class="datetime-container" dir="ltr">
        <button type="button" class="btn btn-success" >موافق</button>
      </div>
     
     
      
       
       <!--table-->
  <div class="table-responsive">  
    <table class="table table-bordered table-striped" >
      <thead >
        <tr>
          <th scope="col">التاريخ</th>
          <th scope="col">اسم المهمة </th>
          <th scope="col">البيان</th>
          <th scope="col">الانجاز</th>
          <th scope="col">مرسلة من</th>
         
        </tr>
      </thead>
      <tbody>
        <tr class="clickable-row" data-href="task-re2.html">
          <td scope="row" >10/06/2020</td>
          <td>نعم</td>
          <td>لا</td>
          <td>200</td>
          <td>عذر</td>
         
        </tr>
        <tr class="clickable-row" data-href="task-re2.html">
          <td scope="row">03/05/2023</td>
          <td>نعم</td>
          <td>لا</td>
          <td>5</td>
          <td>بلا عذر</td>
          
        </tr>
        <tr  class="clickable-row" data-href="task-re2.html">
          <td scope="row">04/06/2024</td>
          <td> لا</td>
          <td>نعم</td>
          <td>8</td>
          <td>بلا عذر</td>
         
        </tr>
      </tbody>
    </table>
  </div>
    <div class="row">
      <div  class="datetime-container">
        <div class="col-md-4 d-flex align-items-center mb-3">
          <label for="inputDebit" class="text-nowrap me-1 px-2"> المهام المعلقة  :</label>
          <input type="text" class="form-control form-control-sm" id="inputDebit" required>
        </div>
    
        
        <div class="col-md-4 d-flex align-items-center mb-3">
          <label for="inputCredit" class="text-nowrap me-1 px-2">   المهام المتوقفة:</label>
          <input type="text" class="form-control form-control-sm" id="inputCredit" required>
        </div>
      </div>
      <div  class="datetime-container">
        <div class="col-md-4 d-flex align-items-center mb-3">
          <label for="inputBalance" class="text-nowrap me-1 px-2">المهام المنجزة  :</label>
          <input type="text" class="form-control form-control-sm" id="inputBalance" required>
        </div>
        <div class="col-md-4 d-flex align-items-center mb-3">
          <label for="inputBalance" class="text-nowrap me-1 px-2"> المهام الحالية  :</label>
          <input type="text" class="form-control form-control-sm" id="inputBalance" required>
        </div>
      </div>  
        
        <button type="button" class="btn btn-secondary" onclick="generatePDF()">طباعه</button>
    </div>
   </div>
</div>
 
  <script>
    
    document.addEventListener('DOMContentLoaded', function() {
        // Row click handlers
        const rows = document.querySelectorAll('.clickable-row');
        rows.forEach(row => {
            row.addEventListener('click', function() {
                const accountNumber = this.cells[0].innerText;
                const accountName = this.cells[1].innerText;
                
                localStorage.setItem('accountData', JSON.stringify({
                    number: accountNumber,
                    name: accountName
                }));
                
                window.location.href = this.dataset.href;
            });
        });
    });
    
    // Print function
    function printContent() {
        window.print();
    }
    
    // PDF generation function
    function generatePDF() {
        // Show loading spinner
        const spinnerEl = document.createElement('div');
        spinnerEl.className = 'print-spinner';
        document.body.appendChild(spinnerEl);
    
        const element = document.getElementById('contentToPrint');
        
        // PDF options
        const opt = {
            margin: [10, 10, 10, 10],
            filename: 'المهام_المستلمة.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { 
                scale: 2,
                useCORS: true,
                logging: true,
                letterRendering: true,
                scrollY: 0,
                windowWidth: document.documentElement.offsetWidth
            },
            jsPDF: { 
                unit: 'mm', 
                format: 'a4', 
                orientation: 'portrait',
                compress: true,
                putOnlyUsedFonts: true,
                language: 'ar'
            }
        };
    
        // Generate PDF using html2pdf
        html2pdf()
            .from(element)
            .set(opt)
            .save()
            .then(() => {
                document.body.removeChild(spinnerEl);
            })
            .catch(err => {
                console.error('Error generating PDF:', err);
                document.body.removeChild(spinnerEl);
                alert('حدث خطأ أثناء إنشاء ملف PDF');
            });
    }
    
    // Add both print and PDF generation buttons
    document.querySelector('.btn-secondary').onclick = function() {
        // Offer both options
        const choice = confirm('هل تريد طباعة المستند مباشرة أم حفظه كملف PDF؟\nاضغط "موافق" للطباعة المباشرة أو "إلغاء" لحفظه كملف PDF');
        if (choice) {
            printContent();
        } else {
            generatePDF();
        }
    };
    </script>
   
<script>
  // Function to set the current date in the date inputs
  function setCurrentDate() {
    const today = new Date().toISOString().split('T')[0]; // Get current date in YYYY-MM-DD format
    document.getElementById('inputDate').value = today;
    document.getElementById('inputDate1').value = today;
  }

  // Call the function when the page loads
  document.addEventListener('DOMContentLoaded', setCurrentDate);
</script>
    <!-- Add html2pdf library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
   
      <script src="/bootstrap-5.3.3-dist/js/bootstrap.bundle.js"></script>
</body>
</html>